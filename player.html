<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø´ØºÙ„ Leo TV</title>
    
    <!-- Video.js - Ù…ÙƒØªØ¨Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet">
    
    <!-- Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Segoe UI', 'Arial', sans-serif;
            overflow: hidden;
            height: 100vh;
        }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header {
            background: linear-gradient(90deg, #1a1a2e, #16213e);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            color: #00b4db;
            font-size: 24px;
        }
        
        .logo h1 {
            font-size: 22px;
            background: linear-gradient(45deg, #00b4db, #0083b0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .channel-info {
            text-align: center;
            flex-grow: 1;
        }
        
        .channel-name {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
        }
        
        .channel-status {
            font-size: 12px;
            color: #aaa;
            margin-top: 3px;
        }
        
        .live-badge {
            background: #ff0000;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: 5px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
        .player-container {
            width: 100%;
            height: calc(100vh - 120px);
            background: #000;
            position: relative;
        }
        
        #my-video {
            width: 100%;
            height: 100%;
        }
        
        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø®ØµØµØ© */
        .custom-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .player-container:hover .custom-controls {
            opacity: 1;
        }
        
        .progress-container {
            width: 100%;
            height: 5px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00b4db, #0083b0);
            width: 0%;
            transition: width 0.1s;
        }
        
        .controls-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .left-controls, .right-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .control-btn {
            background: transparent;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: rgba(255,255,255,0.1);
            transform: scale(1.1);
        }
        
        .control-btn:active {
            transform: scale(0.95);
        }
        
        .play-btn {
            background: #00b4db;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .time-display {
            font-family: monospace;
            font-size: 14px;
            color: #ddd;
        }
        
        .volume-container {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 120px;
        }
        
        .volume-slider {
            width: 80px;
            height: 4px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
            cursor: pointer;
            position: relative;
        }
        
        .volume-level {
            height: 100%;
            background: #00b4db;
            width: 80%;
            border-radius: 2px;
        }
        
        /* Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
        .info-panel {
            position: absolute;
            top: 80px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            border-radius: 10px;
            padding: 15px;
            width: 300px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            display: none;
            z-index: 50;
        }
        
        .info-panel.active {
            display: block;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .info-title {
            font-size: 16px;
            font-weight: bold;
            color: #00b4db;
        }
        
        .close-info {
            background: transparent;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
        }
        
        .info-item {
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .info-label {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 3px;
        }
        
        .info-value {
            font-size: 14px;
            color: #fff;
            word-break: break-all;
        }
        
        /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .message {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            border-left: 4px solid #00b4db;
            z-index: 1000;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        
        .message.show {
            display: block;
            animation: fadeInOut 3s ease;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
            10% { opacity: 1; transform: translateX(-50%) translateY(0); }
            90% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        }
        
        .message.error {
            border-left-color: #ff0000;
        }
        
        .message.success {
            border-left-color: #00ff00;
        }
        
        /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© */
        .back-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateX(-5px);
        }
        
        /* Ø§Ù„ØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
        @media (max-width: 768px) {
            .header {
                padding: 10px 15px;
            }
            
            .logo h1 {
                font-size: 18px;
            }
            
            .channel-name {
                font-size: 16px;
            }
            
            .info-panel {
                width: calc(100% - 40px);
                right: 20px;
                left: 20px;
            }
            
            .custom-controls {
                padding: 15px;
            }
            
            .control-btn {
                font-size: 18px;
            }
            
            .play-btn {
                width: 40px;
                height: 40px;
            }
        }
        
        @media (max-width: 480px) {
            .controls-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .right-controls {
                width: 100%;
                justify-content: space-between;
            }
            
            .volume-container {
                width: 100px;
            }
        }
        
        /* ØªØ¹Ø¯ÙŠÙ„Ø§Øª Video.js */
        .video-js {
            background: #000 !important;
        }
        
        .video-js .vjs-big-play-button {
            background: rgba(0, 180, 219, 0.8) !important;
            border: none !important;
            width: 80px !important;
            height: 80px !important;
            border-radius: 50% !important;
            line-height: 80px !important;
            font-size: 40px !important;
            top: 50% !important;
            left: 50% !important;
            transform: translate(-50%, -50%) !important;
        }
        
        .video-js .vjs-big-play-button:hover {
            background: rgba(0, 180, 219, 1) !important;
            transform: translate(-50%, -50%) scale(1.1) !important;
        }
        
        .video-js .vjs-control-bar {
            background: rgba(0, 0, 0, 0.8) !important;
            backdrop-filter: blur(10px);
            height: 50px !important;
        }
        
        .video-js .vjs-play-progress {
            background: linear-gradient(90deg, #00b4db, #0083b0) !important;
        }
        
        .video-js .vjs-slider {
            background: rgba(255, 255, 255, 0.2) !important;
        }
        
        /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255,255,255,0.1);
            border-top: 5px solid #00b4db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            color: #aaa;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
    <div class="header">
        <div class="logo">
            <i class="fas fa-tv"></i>
            <h1>Leo TV</h1>
        </div>
        
        <div class="channel-info">
            <div class="channel-name" id="currentChannel">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
            <div class="channel-status">
                <span id="streamStatus">ÙŠØªØµÙ„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…</span>
                <span class="live-badge" id="liveBadge">Ù…Ø¨Ø§Ø´Ø±</span>
            </div>
        </div>
        
        <button class="back-btn" onclick="goBack()">
            <i class="fas fa-arrow-right"></i>
            Ø§Ù„Ø¹ÙˆØ¯Ø©
        </button>
    </div>
    
    <!-- Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
    <div class="player-container">
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <div class="loading-text" id="loadingText">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø«...</div>
        </div>
        
        <video
            id="my-video"
            class="video-js vjs-default-skin vjs-big-play-centered"
            controls
            preload="auto"
            playsinline
            crossorigin="anonymous"
        >
            <p class="vjs-no-js">
                Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆØŒ ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ JavaScript Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØµÙØ­ ÙŠØ¯Ø¹Ù… HTML5 video
            </p>
        </video>
        
        <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø®ØµØµØ© -->
        <div class="custom-controls">
            <div class="progress-container" id="progressContainer">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="controls-row">
                <div class="left-controls">
                    <button class="control-btn play-btn" id="playBtn" onclick="togglePlay()">
                        <i class="fas fa-play" id="playIcon"></i>
                    </button>
                    
                    <div class="time-display" id="timeDisplay">
                        <span id="currentTime">00:00</span> / <span id="duration">00:00</span>
                    </div>
                </div>
                
                <div class="right-controls">
                    <div class="volume-container">
                        <button class="control-btn" onclick="toggleMute()" id="volumeBtn">
                            <i class="fas fa-volume-up" id="volumeIcon"></i>
                        </button>
                        <div class="volume-slider" id="volumeSlider">
                            <div class="volume-level" id="volumeLevel"></div>
                        </div>
                    </div>
                    
                    <button class="control-btn" onclick="toggleInfo()" title="Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø«">
                        <i class="fas fa-info-circle"></i>
                    </button>
                    
                    <button class="control-btn" onclick="toggleFullscreen()" title="Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª -->
    <div class="info-panel" id="infoPanel">
        <div class="info-header">
            <div class="info-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø«</div>
            <button class="close-info" onclick="toggleInfo()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="info-item">
            <div class="info-label">Ø§Ù„Ù‚Ù†Ø§Ø©:</div>
            <div class="info-value" id="infoChannel">-</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Ø§Ù„Ø­Ø§Ù„Ø©:</div>
            <div class="info-value" id="infoStatus">-</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Ø§Ù„Ø¯Ù‚Ø©:</div>
            <div class="info-value" id="infoResolution">-</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¨Øª:</div>
            <div class="info-value" id="infoBitrate">-</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Ø§Ù„ØªÙ†Ø³ÙŠÙ‚:</div>
            <div class="info-value" id="infoFormat">-</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Ø§Ù„Ø®Ø§Ø¯Ù…:</div>
            <div class="info-value" id="infoServer">-</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Ø§Ù„Ø±Ø§Ø¨Ø·:</div>
            <div class="info-value" id="infoUrl" style="font-size: 11px;">-</div>
        </div>
    </div>
    
    <!-- Ø±Ø³Ø§Ø¦Ù„ -->
    <div class="message" id="message"></div>

    <!-- Ù…ÙƒØªØ¨Ø© Video.js -->
    <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
    
    <!-- Ø¥Ø¶Ø§ÙØ§Øª Video.js Ù„Ø¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª -->
    <script src="https://cdn.jsdelivr.net/npm/videojs-contrib-hls@5.15.0/dist/videojs-contrib-hls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@videojs/http-streaming@3.0.2/dist/videojs-http-streaming.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/videojs-contrib-dash@3.3.0/dist/videojs-dash.min.js"></script>
    
    <script>
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        let player;
        let currentStreamUrl = '';
        let currentChannelName = 'Ù‚Ù†Ø§Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
        let isPlaying = false;
        let isFullscreen = false;
        let updateInterval;
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´ØºÙ„
        function initPlayer() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø´ØºÙ„...');
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
            const urlParams = new URLSearchParams(window.location.search);
            const streamUrl = urlParams.get('url') || '';
            const channelName = urlParams.get('name') || 'Ù‚Ù†Ø§Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©';
            const channelGroup = urlParams.get('group') || '';
            const channelQuality = urlParams.get('quality') || 'HD';
            
            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            currentStreamUrl = decodeURIComponent(streamUrl);
            currentChannelName = decodeURIComponent(channelName);
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('currentChannel').textContent = currentChannelName;
            document.getElementById('infoChannel').textContent = currentChannelName;
            document.getElementById('infoServer').textContent = channelGroup;
            document.getElementById('infoBitrate').textContent = channelQuality;
            
            // ØªØ­Ø¯ÙŠØ¯ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            const videoType = getVideoType(currentStreamUrl);
            document.getElementById('infoFormat').textContent = videoType;
            
            // ØªÙ‡ÙŠØ¦Ø© Ù…Ø´ØºÙ„ Video.js
            player = videojs('my-video', {
                controls: true,
                autoplay: true,
                preload: 'auto',
                fluid: true,
                responsive: true,
                playbackRates: [0.5, 0.75, 1, 1.25, 1.5, 2],
                html5: {
                    hls: {
                        overrideNative: true,
                        enableLowInitialPlaylist: true,
                        smoothQualityChange: true,
                        bandwidth: 2000000
                    },
                    dash: {
                        overrideNative: true
                    },
                    nativeAudioTracks: false,
                    nativeVideoTracks: false
                },
                controlBar: {
                    children: [
                        'playToggle',
                        'volumePanel',
                        'currentTimeDisplay',
                        'timeDivider',
                        'durationDisplay',
                        'progressControl',
                        'remainingTimeDisplay',
                        'playbackRateMenuButton',
                        'chaptersButton',
                        'fullscreenToggle'
                    ]
                }
            }, function() {
                console.log('âœ… Video.js Ø¬Ø§Ù‡Ø²');
                loadStream();
            });
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            setupEventListeners();
            
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
            }, 1000);
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        function getVideoType(url) {
            const lowerUrl = url.toLowerCase();
            
            if (lowerUrl.includes('.m3u8')) return 'HLS';
            if (lowerUrl.includes('.mpd')) return 'DASH';
            if (lowerUrl.includes('.mp4')) return 'MP4';
            if (lowerUrl.includes('.webm')) return 'WebM';
            if (lowerUrl.includes('.ogg') || lowerUrl.includes('.ogv')) return 'OGG';
            if (lowerUrl.includes('.mov')) return 'MOV';
            if (lowerUrl.includes('.avi')) return 'AVI';
            if (lowerUrl.includes('.mkv')) return 'MKV';
            if (lowerUrl.includes('.flv')) return 'FLV';
            if (lowerUrl.includes('.wmv')) return 'WMV';
            if (lowerUrl.includes('.rtmp://')) return 'RTMP';
            if (lowerUrl.includes('.rtsp://')) return 'RTSP';
            
            return 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø«
        function loadStream() {
            if (!currentStreamUrl) {
                showMessage('âš ï¸ Ù„Ù… ÙŠØªÙ… ØªÙˆÙÙŠØ± Ø±Ø§Ø¨Ø· Ù„Ù„Ø¨Ø«', 'error');
                return;
            }
            
            showMessage('ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø«...', 'info');
            updateStatus('ÙŠØªØµÙ„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…...');
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø®ØªØµØ± ÙÙŠ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
            const shortUrl = currentStreamUrl.length > 50 
                ? currentStreamUrl.substring(0, 50) + '...' 
                : currentStreamUrl;
            document.getElementById('infoUrl').textContent = shortUrl;
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø«
            try {
                player.src({
                    src: currentStreamUrl,
                    type: getVideoType(currentStreamUrl) === 'HLS' ? 'application/x-mpegURL' :
                          getVideoType(currentStreamUrl) === 'DASH' ? 'application/dash+xml' : 'video/mp4'
                });
                
                // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                startUpdateInterval();
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø«:', error);
                showMessage(`âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø«: ${error.message}`, 'error');
                updateStatus('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„');
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function setupEventListeners() {
            // Ø­Ø¯Ø« ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            player.on('loadedmetadata', function() {
                console.log('âœ… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø­Ù…Ù„Ø©');
                updateStatus('Ù…Ø³ØªØ¹Ø¯ Ù„Ù„ØªØ´ØºÙŠÙ„');
                showMessage('âœ… Ø§Ù„Ø¨Ø« Ø¬Ø§Ù‡Ø²', 'success');
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯Ù‚Ø©
                const videoWidth = player.videoWidth();
                const videoHeight = player.videoHeight();
                document.getElementById('infoResolution').textContent = `${videoWidth} Ã— ${videoHeight}`;
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
                updateTimeDisplay();
            });
            
            // Ø­Ø¯Ø« Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
            player.on('play', function() {
                isPlaying = true;
                document.getElementById('playIcon').className = 'fas fa-pause';
                updateStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„');
            });
            
            // Ø­Ø¯Ø« Ø§Ù„ØªÙˆÙ‚Ù
            player.on('pause', function() {
                isPlaying = false;
                document.getElementById('playIcon').className = 'fas fa-play';
                updateStatus('Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹');
            });
            
            // Ø­Ø¯Ø« Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± (Ø§Ù„ØªØ­Ù…ÙŠÙ„)
            player.on('waiting', function() {
                updateStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...');
                document.getElementById('loading').style.display = 'block';
            });
            
            // Ø­Ø¯Ø« Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„ØªØ´ØºÙŠÙ„
            player.on('playing', function() {
                document.getElementById('loading').style.display = 'none';
                updateStatus('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„');
            });
            
            // Ø­Ø¯Ø« Ø§Ù„Ø®Ø·Ø£
            player.on('error', function() {
                const error = player.error();
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ:', error);
                
                let errorMessage = 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                if (error) {
                    switch(error.code) {
                        case 1: errorMessage = 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„'; break;
                        case 2: errorMessage = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©'; break;
                        case 3: errorMessage = 'Ø®Ø·Ø£ ÙÙŠ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±'; break;
                        case 4: errorMessage = 'ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'; break;
                    }
                }
                
                showMessage(`âŒ Ø®Ø·Ø£: ${errorMessage}`, 'error');
                updateStatus('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„');
                document.getElementById('infoStatus').textContent = errorMessage;
            });
            
            // Ø­Ø¯Ø« ØªØºÙŠÙŠØ± Ø§Ù„Ø¯Ù‚Ø©
            player.on('resolutionchange', function() {
                const videoWidth = player.videoWidth();
                const videoHeight = player.videoHeight();
                document.getElementById('infoResolution').textContent = `${videoWidth} Ã— ${videoHeight}`;
            });
            
            // Ø­Ø¯Ø« Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„
            player.on('ended', function() {
                showMessage('âœ… Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¨Ø«', 'info');
                updateStatus('Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¨Ø«');
            });
            
            // Ø­Ø¯Ø« ØªØºÙŠÙŠØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª
            player.on('volumechange', function() {
                updateVolumeDisplay();
            });
            
            // Ø­Ø¯Ø« ØªØºÙŠÙŠØ± Ø§Ù„ÙˆÙ‚Øª
            player.on('timeupdate', function() {
                updateProgressBar();
                updateTimeDisplay();
            });
            
            // Ù…Ø³ØªÙ…Ø¹ Ù„ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            document.addEventListener('fullscreenchange', handleFullscreenChange);
            document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
            document.addEventListener('mozfullscreenchange', handleFullscreenChange);
            document.addEventListener('MSFullscreenChange', handleFullscreenChange);
            
            // Ù…Ø³ØªÙ…Ø¹ Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø®ØµØµØ©
            setupCustomControls();
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø®ØµØµØ©
        function setupCustomControls() {
            // Ø²Ø± Ø§Ù„ØªØ´ØºÙŠÙ„/Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù
            document.getElementById('playBtn').addEventListener('click', togglePlay);
            
            // Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            const progressContainer = document.getElementById('progressContainer');
            progressContainer.addEventListener('click', function(e) {
                const rect = this.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                if (player.duration()) {
                    player.currentTime(player.duration() * percent);
                }
            });
            
            // ØªØ­ÙƒÙ… Ø§Ù„ØµÙˆØª
            const volumeSlider = document.getElementById('volumeSlider');
            volumeSlider.addEventListener('click', function(e) {
                const rect = this.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                player.volume(percent);
                updateVolumeDisplay();
            });
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
        function updateProgressBar() {
            if (player.duration()) {
                const percent = (player.currentTime() / player.duration()) * 100;
                document.getElementById('progressBar').style.width = percent + '%';
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ÙˆÙ‚Øª
        function updateTimeDisplay() {
            const currentTime = formatTime(player.currentTime());
            const duration = formatTime(player.duration());
            
            document.getElementById('currentTime').textContent = currentTime;
            document.getElementById('duration').textContent = duration;
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª
        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '00:00';
            
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = Math.floor(seconds % 60);
            
            if (hours > 0) {
                return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            } else {
                return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØª
        function updateVolumeDisplay() {
            const volume = player.volume();
            const isMuted = player.muted();
            
            document.getElementById('volumeLevel').style.width = (volume * 100) + '%';
            
            if (isMuted || volume === 0) {
                document.getElementById('volumeIcon').className = 'fas fa-volume-mute';
            } else if (volume < 0.5) {
                document.getElementById('volumeIcon').className = 'fas fa-volume-down';
            } else {
                document.getElementById('volumeIcon').className = 'fas fa-volume-up';
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ´ØºÙŠÙ„ ÙˆØ§Ù„Ø¥ÙŠÙ‚Ø§Ù
        function togglePlay() {
            if (isPlaying) {
                player.pause();
            } else {
                player.play();
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† ÙƒØªÙ… ÙˆØ¥Ù„ØºØ§Ø¡ ÙƒØªÙ… Ø§Ù„ØµÙˆØª
        function toggleMute() {
            player.muted(!player.muted());
            updateVolumeDisplay();
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù†Ù‡
        function toggleFullscreen() {
            if (!isFullscreen) {
                if (player.requestFullscreen) {
                    player.requestFullscreen();
                } else if (player.webkitRequestFullscreen) {
                    player.webkitRequestFullscreen();
                } else if (player.mozRequestFullScreen) {
                    player.mozRequestFullScreen();
                } else if (player.msRequestFullscreen) {
                    player.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØºÙŠÙŠØ± ÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
        function handleFullscreenChange() {
            isFullscreen = !!(document.fullscreenElement || 
                              document.webkitFullscreenElement || 
                              document.mozFullScreenElement || 
                              document.msFullscreenElement);
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø¹Ø±Ø¶ ÙˆØ¥Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
        function toggleInfo() {
            document.getElementById('infoPanel').classList.toggle('active');
        }
        
        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø«
        function updateStatus(status) {
            document.getElementById('streamStatus').textContent = status;
            document.getElementById('infoStatus').textContent = status;
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
        function showMessage(text, type = 'info') {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = `message ${type} show`;
            
            setTimeout(() => {
                messageEl.classList.remove('show');
            }, 3000);
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        function goBack() {
            if (player) {
                player.dispose();
            }
            window.history.back();
        }
        
        // Ø¯Ø§Ù„Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function startUpdateInterval() {
            if (updateInterval) clearInterval(updateInterval);
            
            updateInterval = setInterval(() => {
                updateTimeDisplay();
                updateProgressBar();
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø«
                if (player.readyState() >= 2) {
                    updateStatus('Ù…Ø³ØªÙ‚Ø±');
                }
            }, 100);
        }
        
        // Ù…Ø³ØªÙ…Ø¹ Ù„Ø£Ø²Ø±Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        document.addEventListener('keydown', function(e) {
            // ØªØ¬Ø§Ù‡Ù„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
            
            switch(e.key) {
                case ' ':
                case 'k':
                    e.preventDefault();
                    togglePlay();
                    break;
                    
                case 'f':
                    e.preventDefault();
                    toggleFullscreen();
                    break;
                    
                case 'm':
                    e.preventDefault();
                    toggleMute();
                    break;
                    
                case 'ArrowLeft':
                    e.preventDefault();
                    player.currentTime(player.currentTime() - 10);
                    break;
                    
                case 'ArrowRight':
                    e.preventDefault();
                    player.currentTime(player.currentTime() + 10);
                    break;
                    
                case 'ArrowUp':
                    e.preventDefault();
                    player.volume(Math.min(1, player.volume() + 0.1));
                    updateVolumeDisplay();
                    break;
                    
                case 'ArrowDown':
                    e.preventDefault();
                    player.volume(Math.max(0, player.volume() - 0.1));
                    updateVolumeDisplay();
                    break;
                    
                case 'i':
                case 'I':
                    e.preventDefault();
                    toggleInfo();
                    break;
                    
                case 'Escape':
                    if (isFullscreen) {
                        toggleFullscreen();
                    }
                    break;
            }
        });
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø´ØºÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', initPlayer);
        
        // ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', function() {
            if (player) {
                player.dispose();
            }
            if (updateInterval) {
                clearInterval(updateInterval);
            }
        });
    </script>
</body>
</html>
